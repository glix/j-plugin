/*
 * 	portBox 1.0 - jQuery plugin
 *	written by Joey Navarro	http://www.joeynavarro.com
 *	Copyright (c) 2013 Joey Navarro (http://www.joeynavarro.com)
 *	Dual licensed under the MIT (MIT-LICENSE.txt)
 *	and GPL (GPL-LICENSE.txt) licenses.
 */
(function(e){e(document).on("click","[data-display]",function(t){t.preventDefault();var n=e(this).attr("data-display");e("#"+n).display(e(this).data())});e.fn.display=function(t){var n={animation:"fade",animationspeed:200,closeBGclick:true};t=e.extend({},n,t);return this.each(function(){function u(){r=false}function a(){r=true}var n=e(this),r=false,i=e(".portBox-overlay"),s;var o=false;if(navigator.userAgent.match(/Windows Phone/i)){o=true}if(i.length==0){i=e('<div class="portBox-overlay" />').insertAfter(n)}if(typeof e.fn.slimScroll=="function"){s=true}else{s=false}if(n.has(".scrollBar").length==0&&s==true){n.wrapInner('<div class="scrollBar" style="padding-right:20px;" />'),n.css({"padding-right":10});e(function(){e(".scrollBar").slimScroll({height:"100%"})});n.append('<a class="close-portBox">&#215;</a>')}if(n.has(".close-portBox").length==0&&s==false){n.append('<a class="close-portBox">&#215;</a>')}n.center=function(){var t,r;if(n.outerHeight()+25>e(window).height()&&s===true&&o===false){var i=e(window).height()-80;n.css({height:i+"px"})}n.css({top:0,left:0});t=Math.max(e(window).height()-n.outerHeight(),0)/2;r=Math.max(e(window).width()-n.outerWidth(),0)/2;n.css({top:t+e(window).scrollTop(),left:r+e(window).scrollLeft()});if(n.innerWidth()+10>=e(window).width()){n.css({"margin-right":5+"px"}),e(".close-portBox").css({top:3,right:3})}else{n.css({"margin-right":0+"px"}),e(".close-portBox").css({top:-6,right:-7})}if(n.outerHeight()>=e(window).height()&&s==false){n.css({top:20+e(window).scrollTop()})}};n.center();e(window).on("resize.portBox",n.center);n.on("portBox:open",function(){if(!r){a();if(t.animation==""){n.css({display:"block"}),i.css({display:"block"});u()}else{i.fadeIn(t.animationspeed);n.show(t.animation,t.animationspeed);u()}}});n.on("portBox:close",function(){if(!r){a();if(t.animation==""){n.css({display:"none"}),i.css({display:"none"});u()}else{i.fadeOut(t.animationspeed),n.fadeOut(t.animationspeed);u()}e(window).off("resize.portBox")}});n.trigger("portBox:open");var f=e(".close-portBox").one("click.portBoxEvent",function(){n.trigger("portBox:close")});if(t.closeBGclick){i.css({cursor:"pointer"});i.one("click.portBoxEvent",function(){n.trigger("portBox:close")})}e("body").keyup(function(e){if(e.which===27){n.trigger("portBox:close")}})})}})(jQuery);